{% extends 'base.html' %}
{% load static %} {% block title %}Create New Post{% endblock %}
{% block head-css %}
<link rel="stylesheet" href="{% static 'css/post.css' %}" />
<link rel="stylesheet" href="{% static 'css/create_post.css' %}" />
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css"
/>
{% endblock %}
{% block content %}
<div class="post-form-container">
    <h1 class="form-title">‚úçÔ∏è Create New Blog Post</h1>

    <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}

        <div class="form-grid">
            <!-- Title Field -->
            <div class="form-group">
                <label for="{{ form.title.id_for_label }}"
                    >{{ form.title.label }}</label
                >
                {{ form.title }}
                <div class="char-counter" id="title-counter">0/200</div>
                {% if form.title.help_text %}
                <div class="help-text">{{ form.title.help_text }}</div>
                {% endif %} {% if form.title.errors %}
                <ul class="errorlist">
                    {% for error in form.title.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- URL Slug Field -->
            <div class="form-group">
                <label for="{{ form.url_slug.id_for_label }}"
                    >{{ form.url_slug.label }}</label
                >
                {{ form.url_slug }} {% if form.url_slug.help_text %}
                <div class="help-text">{{ form.url_slug.help_text }}</div>
                {% endif %} {% if form.url_slug.errors %}
                <ul class="errorlist">
                    {% for error in form.url_slug.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- Meta Description Field -->
            <div class="form-group full-width">
                <label for="{{ form.meta_description.id_for_label }}"
                    >{{ form.meta_description.label }}</label
                >
                {{ form.meta_description }}
                <div class="char-counter" id="meta-counter">0/160</div>
                {% if form.meta_description.help_text %}
                <div class="help-text">
                    {{ form.meta_description.help_text }}
                </div>
                {% endif %} {% if form.meta_description.errors %}
                <ul class="errorlist">
                    {% for error in form.meta_description.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
        </div>

        <!-- Rich Text Editor -->
        <div class="form-group full-width">
            <label for="rich-editor-container">{{ form.text.label }}</label>

            <!-- Media Upload Section -->
            <div class="media-upload-section">
                <h4 style="margin-bottom: 1rem; color: #264d60">
                    üìé Add Media
                </h4>
                <div class="media-buttons">
                    <button
                        type="button"
                        class="media-btn"
                        onclick="document.getElementById('image-upload').click()"
                    >
                        <i>üñºÔ∏è</i> Add Image
                    </button>
                    <button
                        type="button"
                        class="media-btn"
                        onclick="document.getElementById('video-upload').click()"
                    >
                        <i>üé•</i> Add Video
                    </button>
                    <button
                        type="button"
                        class="media-btn"
                        onclick="insertTable()"
                    >
                        <i>üìä</i> Insert Table
                    </button>
                    <button
                        type="button"
                        class="media-btn"
                        onclick="insertHeading()"
                    >
                        <i>üìù</i> Add Heading
                    </button>
                </div>

                <!-- Hidden file inputs -->
                <input
                    type="file"
                    id="image-upload"
                    class="hidden-input"
                    accept="image/*"
                    onchange="handleImageUpload(event)"
                />
                <input
                    type="file"
                    id="video-upload"
                    class="hidden-input"
                    accept="video/*"
                    onchange="handleVideoUpload(event)"
                />

                <!-- Media preview area -->
                <div
                    id="media-preview"
                    class="media-preview"
                    style="display: none"
                ></div>
            </div>

            <!-- Rich Text Editor Container -->
            <div class="editor-container">
                <div id="rich-editor-container" style="min-height: 400px"></div>
            </div>

            <!-- Hidden textarea for form submission -->
            <textarea name="text" id="id_text" style="display: none">
{{ form.text.value|default:'' }}</textarea
            >

            {% if form.text.help_text %}
            <div class="help-text">{{ form.text.help_text }}</div>
            {% endif %} {% if form.text.errors %}
            <ul class="errorlist">
                {% for error in form.text.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

        <div class="form-buttons">
            <a href="{% url 'home' %}" class="btn-cancel">Cancel</a>
            <button type="submit" class="btn-submit">üöÄ Publish Post</button>
        </div>
    </form>
</div>
{% endblock %} {% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
<script src="{% static 'scripts/create_post.js' %}"></script>
{% endblock %}
